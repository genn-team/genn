<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>GeNN: Weight update models</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../multi-language-utils.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="../../html_styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="../../GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">4.8.1</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/d24/sectSynapseModels.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Weight update models </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Currently 4 predefined weight update models are available:</p><ul>
<li><a class="el" href="../../d9/d74/classWeightUpdateModels_1_1StaticPulse.html" title="Pulse-coupled, static synapse. ">WeightUpdateModels::StaticPulse</a></li>
<li><a class="el" href="../../d2/d53/classWeightUpdateModels_1_1StaticPulseDendriticDelay.html" title="Pulse-coupled, static synapse with heterogenous dendritic delays. ">WeightUpdateModels::StaticPulseDendriticDelay</a></li>
<li><a class="el" href="../../d6/d64/classWeightUpdateModels_1_1StaticGraded.html" title="Graded-potential, static synapse. ">WeightUpdateModels::StaticGraded</a></li>
<li><a class="el" href="../../df/d86/classWeightUpdateModels_1_1PiecewiseSTDP.html" title="This is a simple STDP rule including a time delay for the finite transmission speed of the synapse...">WeightUpdateModels::PiecewiseSTDP</a></li>
</ul>
<p> <div class='toggleable_div label_python' style='display: none;'> In Python, these models can be selected by their unqualified name e.g. "StaticPulse".  </div></p>
<h1><a class="anchor" id="sect34"></a>
Defining a new weight update model</h1>
<p>Like the neuron models discussed in <a class="el" href="../../de/ded/sectNeuronModels.html#sect_own">Defining your own neuron type</a>, new weight update models are created by defining a class derived from <a class="el" href="../../d2/d05/classWeightUpdateModels_1_1Base.html" title="Base class for all weight update models. ">WeightUpdateModels::Base</a>. For convenience, <span class='toggleable_div label_cpp' style='display: none;'>the methods a new weight update model should implement can be implemented using the following basic macros</span><span class='toggleable_div label_python' style='display: none;'>new weight update models should be implemented using the <code><a class="el" href="../../de/d6e/namespacepygenn_1_1genn__model.html#a7c2e854789f74d6ffd92be2a487a0e5b" title="This helper function creates a custom WeightUpdateModel class. ">pygenn.genn_model.create_custom_weight_update_class</a></code> function with the following basic keyword arguments</span>:</p><ul>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../de/d6c/snippet_8h.html#aa592bfe3ce05ffc19a8f21d8482add6b">SET_DERIVED_PARAMS()</a>, <a class="el" href="../../de/d6c/snippet_8h.html#a75315265035fd71c5b5f7d7f449edbd7">SET_PARAM_NAMES()</a>, <a class="el" href="../../d4/d13/models_8h.html#a3025b9fc844fccdf8cc2b51ef4a6e0aa">SET_VARS()</a> and <a class="el" href="../../de/d6c/snippet_8h.html#aa33e3634a531794ddac1ad49bde09071">SET_EXTRA_GLOBAL_PARAMS()</a></span><span class='toggleable_div label_python' style='display: none;'> <code>derived_params</code>, <code>param_names</code>, <code>var_name_types</code> and <code>extra_global_params</code> </span> perform the same roles as they do in the neuron models discussed in <a class="el" href="../../de/ded/sectNeuronModels.html#sect_own">Defining your own neuron type</a>.</li>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a611a9113f742a9d07d3def4298a0ea68">DECLARE_WEIGHT_UPDATE_MODEL(TYPE, NUM_PARAMS, NUM_VARS, NUM_PRE_VARS, NUM_POST_VARS)</a> is an extended version of <code><a class="el" href="../../d4/d13/models_8h.html#ae0c817e85c196f39cf62d608883cda13">DECLARE_MODEL()</a></code> which declares the boilerplate code required for a weight update model with pre and postsynaptic as well as per-synapse state variables</span><span class='toggleable_div label_python' style='display: none;'><code>class_name</code>: the name of the new model </span>.</li>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE(SIM_CODE)</a></span><span class='toggleable_div label_python' style='display: none;'><code>sim_code=SIM_CODE</code> </span>: defines the simulation code that is used when a true spike is detected. The update is performed only in timesteps after a neuron in the presynaptic population has fulfilled its threshold detection condition. Typically, spikes lead to update of synaptic variables that then lead to the activation of input into the post-synaptic neuron. Most of the time these inputs add linearly at the post-synaptic neuron. This is assumed in GeNN and the term to be added to the activation of the post-synaptic neuron should be applied using the the $(addToInSyn, weight) function. For example  <div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line"><a class="code" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE</a>(</div><div class="line">    <span class="stringliteral">&quot;$(addToInSyn, $(inc));&quot;</span></div></div><!-- fragment --> </div>  <div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">sim_code=<span class="stringliteral">&quot;$(addToInSyn, $(inc));&quot;</span></div></div><!-- fragment --> </div> where "inc" is the increment of the synaptic input to a post-synaptic neuron for each pre-synaptic spike. The simulation code also typically contains updates to the internal synapse variables that may have contributed to $(inc). For an example, see <a class="el" href="../../d9/d74/classWeightUpdateModels_1_1StaticPulse.html" title="Pulse-coupled, static synapse. ">WeightUpdateModels::StaticPulse</a> for a simple synapse update model and <a class="el" href="../../df/d86/classWeightUpdateModels_1_1PiecewiseSTDP.html" title="This is a simple STDP rule including a time delay for the finite transmission speed of the synapse...">WeightUpdateModels::PiecewiseSTDP</a> for a more complicated model that uses STDP. To apply input to the post-synaptic neuron with a dendritic (i.e. between the synapse and the postsynaptic neuron) delay you can instead use the $(addToInSynDelay, weight, delay) function. For example  <div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line"><a class="code" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE</a>(</div><div class="line">    <span class="stringliteral">&quot;$(addToInSynDelay, $(inc), $(delay));&quot;</span>);</div></div><!-- fragment --> </div>  <div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">sim_code=<span class="stringliteral">&quot;$(addToInSynDelay, $(inc), $(delay));&quot;</span></div></div><!-- fragment --> </div> where, once again, $(inc) is the magnitude of the input step to apply and <code>delay</code> is the length of the dendritic delay in timesteps. By implementing <code>delay</code> as a weight update model variable, heterogeneous synaptic delays can be implemented. For an example, see <a class="el" href="../../d2/d53/classWeightUpdateModels_1_1StaticPulseDendriticDelay.html" title="Pulse-coupled, static synapse with heterogenous dendritic delays. ">WeightUpdateModels::StaticPulseDendriticDelay</a> for a simple synapse update model with heterogeneous dendritic delays. <dl class="section note"><dt>Note</dt><dd>When using dendritic delays, the <b>maximum</b> dendritic delay for a synapse populations must be specified using the <code><a class="el" href="../../dc/dfa/classSynapseGroup.html#a220307d4043e8bf1bed07552829f2a17" title="Sets the maximum dendritic delay for synapses in this synapse group. ">SynapseGroup::setMaxDendriticDelayTimesteps()</a></code> function.</dd></dl>
One can also define synaptic effects that occur in the reverse direction, i.e. terms that are added to a target variable in the persynaptic neuron using the $(addToPre, expression) function. For instance,  <div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line"><a class="code" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE</a>(</div><div class="line">    <span class="stringliteral">&quot;$(addToPre, $(inc)*$(V_post));&quot;</span>);</div></div><!-- fragment --> </div>  <div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">sim_code=<span class="stringliteral">&quot;$(addToPre, $(inc)*$(V_post));&quot;</span></div></div><!-- fragment --> </div> would add terms $(inc)*$(V_post) to the predefined presynaptic variable $(Isyn) for each outgoing synapse of a presynaptic neuron. One can also set alternative input variables in the presynaptic neuron as the target variable of this reverse input using <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dfa/classSynapseGroup.html#ae67a3a99867ab771b6a34a04cfac8ca8" title="Set name of neuron input variable $(addToPre, . ) commands will target. ">SynapseGroup::setPreTargetVar()</a></span><span class='toggleable_div label_python' style='display: none;'><code><a class="el" href="../../d5/d49/classpygenn_1_1genn__groups_1_1SynapseGroup.html#a686965cc8e0919416de4c3af535be337" title="Gets name of neuron input variable  will target. ">pygenn.SynapseGroup.pre_target_var</a></code> </span>, see section <a class="el" href="../../de/ded/sectNeuronModels.html#neuron_additional_input">Additional input variables</a> on how to define additional input variables for a neuron population. <dl class="section note"><dt>Note</dt><dd>$(addToPre, expression) can be used in <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE()</a></span><span class='toggleable_div label_python' style='display: none;'><code>sim_code</code> </span>, <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a8159c6f595e865d6bf609f045c07361e">SET_EVENT_CODE()</a></span><span class='toggleable_div label_python' style='display: none;'><code>event_code</code> </span>, <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#ae68b0e54b73f5cda5fe9bab3667de3a8">SET_SYNAPSE_DYNAMICS_CODE()</a></span><span class='toggleable_div label_python' style='display: none;'><code>synapse_dynamics_code</code> </span>, <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a9f1ad825b90bcbaab3b0d18fc4d00016">SET_LEARN_POST_CODE()</a></span><span class='toggleable_div label_python' style='display: none;'><code>learn_post_code</code> </span>. </dd>
<dd>
Unlike for normal forward synaptic actions, reverse synaptic actions with $(addToPre,$(inc)) are not modulated through a post-synaptic model but added directly into the indicated presynaptic target input variable, such as $(Isyn).</dd></dl>
</li>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a9f1ad825b90bcbaab3b0d18fc4d00016">SET_LEARN_POST_CODE(LEARN_POST_CODE)</a></span><span class='toggleable_div label_python' style='display: none;'><code>learn_post_code=LEARN_POST_CODE</code> </span> defines the code which is used in the learnSynapsesPost kernel/function, which performs updates to synapses that are triggered by post-synaptic spikes. This is typically used in STDP-like models e.g. <a class="el" href="../../df/d86/classWeightUpdateModels_1_1PiecewiseSTDP.html" title="This is a simple STDP rule including a time delay for the finite transmission speed of the synapse...">WeightUpdateModels::PiecewiseSTDP</a>.</li>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#ad06378df00a5d9ffe4068ba2c01b09ab">SET_NEEDS_PRE_SPIKE_TIME(PRE_SPIKE_TIME_REQUIRED)</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a4f3e008922887cba8cfafc0fb0e53965">SET_NEEDS_POST_SPIKE_TIME(POST_SPIKE_TIME_REQUIRED)</a></span><span class='toggleable_div label_python' style='display: none;'><code>is_pre_spike_time_required=PRE_SPIKE_TIME_REQUIRED</code> and <code>is_post_spike_time_required=POST_SPIKE_TIME_REQUIRED</code> </span> define whether the weight update needs to know the times of the spikes emitted from the pre and postsynaptic populations. These can then be accessed through $(sT_pre) and $(sT_post). For example an STDP rule would be likely to require:  <div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line"><a class="code" href="../../dc/dab/weightUpdateModels_8h.html#ad06378df00a5d9ffe4068ba2c01b09ab">SET_NEEDS_PRE_SPIKE_TIME</a>(<span class="keyword">true</span>);</div><div class="line"><a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a4f3e008922887cba8cfafc0fb0e53965">SET_NEEDS_POST_SPIKE_TIME</a>(<span class="keyword">true</span>);</div></div><!-- fragment --> </div>  <div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">is_pre_spike_time_required=True, is_post_spike_time_required=True</div></div><!-- fragment --> </div></li>
<li> <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#abe55020d64a8ec4a28679655ef8c4eb1">SET_NEEDS_PREV_PRE_SPIKE_TIME(PREV_PRE_SPIKE_TIME_REQUIRED)</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a689cf929f3384f6ac4e47d3cfe89182e">SET_NEEDS_PREV_POST_SPIKE_TIME(PREV_POST_SPIKE_TIME_REQUIRED)</a></span><span class='toggleable_div label_python' style='display: none;'><code>is_prev_pre_spike_time_required=PREV_PRE_SPIKE_TIME_REQUIRED</code> and <code>is_prev_post_spike_time_required=PREV_POST_SPIKE_TIME_REQUIRED</code> </span> define whether the weight update needs to know the times of the previous (i.e. not the ones being processed this timeste) spikes emitted from the pre and postsynaptic populations. These can then be accessed through $(prev_sT_pre) and $(prev_sT_post).</li>
</ul>
<p>For example, we can define a simple additive STDP rule with nearest-neighbour spike pairing and the following time-dependence: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \Delta w_{ij} &amp; = \ \begin{cases} A_{+}\exp\left(-\frac{\Delta t}{\tau_{+}}\right) &amp; if\, \Delta t&gt;0\\ A_{-}\exp\left(\frac{\Delta t}{\tau_{-}}\right) &amp; if\, \Delta t\leq0 \end{cases} \end{align*}" src="../../form_4.png"/>
</p>
<p> in a fully event-driven manner as follows:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><span class="keyword">class </span>STDPAdditive : <span class="keyword">public</span> <a class="code" href="../../d2/d05/classWeightUpdateModels_1_1Base.html">WeightUpdateModels::Base</a></div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a611a9113f742a9d07d3def4298a0ea68">DECLARE_WEIGHT_UPDATE_MODEL</a>(STDPAdditive, 6, 1, 0, 0);</div><div class="line"></div><div class="line">    <a class="code" href="../../de/d6c/snippet_8h.html#a75315265035fd71c5b5f7d7f449edbd7">SET_PARAM_NAMES</a>({<span class="stringliteral">&quot;tauPlus&quot;</span>, <span class="stringliteral">&quot;tauMinus&quot;</span>, <span class="stringliteral">&quot;Aplus&quot;</span>, <span class="stringliteral">&quot;Aminus&quot;</span>,</div><div class="line">                     <span class="stringliteral">&quot;Wmin&quot;</span>, <span class="stringliteral">&quot;Wmax&quot;</span>});</div><div class="line">    <a class="code" href="../../d4/d13/models_8h.html#a3025b9fc844fccdf8cc2b51ef4a6e0aa">SET_VARS</a>({{<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>}});</div><div class="line"></div><div class="line">    <a class="code" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;$(addToInSyn, $(g));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;const scalar dt = $(t) - $(sT_post); \n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;if (dt &gt; 0) {\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar timing = exp(-dt / $(tauMinus));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar newWeight = $(g) - ($(Aminus) * timing);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a9f1ad825b90bcbaab3b0d18fc4d00016">SET_LEARN_POST_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;const scalar dt = $(t) - $(sT_pre);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;if (dt &gt; 0) {\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar timing = exp(-dt / $(tauPlus));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar newWeight = $(g) + ($(Aplus) * timing);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#ad06378df00a5d9ffe4068ba2c01b09ab">SET_NEEDS_PRE_SPIKE_TIME</a>(<span class="keyword">true</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a4f3e008922887cba8cfafc0fb0e53965">SET_NEEDS_POST_SPIKE_TIME</a>(<span class="keyword">true</span>);</div><div class="line">};</div><div class="line"><a class="code" href="../../d4/d13/models_8h.html#a0f3d066ed16dd93ee24912f38826520b">IMPLEMENT_MODEL</a>(STDPAdditive);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">stdp_additive_model = genn_model.create_custom_weight_update_class(</div><div class="line">    <span class="stringliteral">&quot;stdp_additive&quot;</span>,</div><div class="line">    param_names=[<span class="stringliteral">&quot;tauPlus&quot;</span>, <span class="stringliteral">&quot;tauMinus&quot;</span>, <span class="stringliteral">&quot;aPlus&quot;</span>, <span class="stringliteral">&quot;aMinus&quot;</span>, <span class="stringliteral">&quot;wMin&quot;</span>, <span class="stringliteral">&quot;wMax&quot;</span>],</div><div class="line">    var_name_types=[(<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>)],</div><div class="line"></div><div class="line">    sim_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(addToInSyn, $(g));</span></div><div class="line"><span class="stringliteral">        const scalar dt = $(t) - $(sT_post);</span></div><div class="line"><span class="stringliteral">        if (dt &gt; 0) {</span></div><div class="line"><span class="stringliteral">            const scalar timing = exp(-dt / $(tauMinus));</span></div><div class="line"><span class="stringliteral">            const scalar newWeight = $(g) - ($(Aminus) * timing);</span></div><div class="line"><span class="stringliteral">            $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));</span></div><div class="line"><span class="stringliteral">        }</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    learn_post_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        const scalar dt = $(t) - $(sT_pre);</span></div><div class="line"><span class="stringliteral">        if (dt &gt; 0) {</span></div><div class="line"><span class="stringliteral">            const scalar timing = exp(-dt / $(tauPlus));</span></div><div class="line"><span class="stringliteral">            const scalar newWeight = $(g) + ($(Aplus) * timing);</span></div><div class="line"><span class="stringliteral">            $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));</span></div><div class="line"><span class="stringliteral">        }</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line"></div><div class="line">    is_pre_spike_time_required=True,</div><div class="line">    is_post_spike_time_required=True)</div></div><!-- fragment --><p> </div></p>
<h2><a class="anchor" id="wum_pre_post_dynamics"></a>
Pre and postsynaptic dynamics</h2>
<p>The memory required for synapse variables and the computational cost of updating them tends to grow with <img class="formulaInl" alt="$O(N^2)$" src="../../form_5.png"/> with the number of neurons. Therefore, if it is possible, implementing synapse variables on a per-neuron rather than per-synapse basis is a good idea. The <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a9a2bc6f56fa2bfb7008e915710720cfd">SET_PRE_VARS()</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a906e656a5980ea57c9f1b7c3185e876b">SET_POST_VARS()</a> macros</span><span class='toggleable_div label_python' style='display: none;'> <code>pre_var_name_types</code> and <code>post_var_name_types</code> keyword arguments </span> are used to define any pre or postsynaptic state variables. Then the <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#ab7d8b101bdb0b7d593c9cc82f75a6853">SET_PRE_DYNAMICS_CODE()</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a52759a81ea3269567b96c7b07a430ea6">SET_POST_DYNAMICS_CODE()</a> macros</span><span class='toggleable_div label_python' style='display: none;'> <code>pre_dynamics_code</code> and <code>post_dynamics_code</code> keyword arguments </span> can be used to define any time-driven updates to these variables and the <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#aede2f97f853841236f081c8d7b9d156f">SET_PRE_SPIKE_CODE()</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#aef99e5858038673e6b268f4af07864c2">SET_POST_SPIKE_CODE()</a> macros</span><span class='toggleable_div label_python' style='display: none;'> <code>pre_spike_code</code> and <code>post_spike_code</code> keyword arguments </span> any spike-driven updates. For example, using pre and postsynaptic variables, our event-driven STDP rule can be extended to use all-to-all spike pairing using pre and postsynaptic <em>trace</em> variables <a class="el" href="../../d0/de3/citelist.html#CITEREF_Morrison2008">[4]</a> : </p><dl class="section note"><dt>Note</dt><dd>These pre and postsynaptic code snippets can only access the corresponding pre and postsynaptic variables as well as those associated with the pre or postsynaptic neuron population. Like other state variables, variables defined here as <code>NAME</code> can be accessed in weight update model code strings using the $(NAME) syntax.</dd></dl>
<p> <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><span class="keyword">class </span>STDPAdditive2 : <span class="keyword">public</span> <a class="code" href="../../d2/d05/classWeightUpdateModels_1_1Base.html">WeightUpdateModels::Base</a></div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a611a9113f742a9d07d3def4298a0ea68">DECLARE_WEIGHT_UPDATE_MODEL</a>(STDPAdditive2, 6, 1, 1, 1);</div><div class="line"></div><div class="line">    <a class="code" href="../../de/d6c/snippet_8h.html#a75315265035fd71c5b5f7d7f449edbd7">SET_PARAM_NAMES</a>({<span class="stringliteral">&quot;tauPlus&quot;</span>, <span class="stringliteral">&quot;tauMinus&quot;</span>, <span class="stringliteral">&quot;Aplus&quot;</span>, <span class="stringliteral">&quot;Aminus&quot;</span>,</div><div class="line">                     <span class="stringliteral">&quot;Wmin&quot;</span>, <span class="stringliteral">&quot;Wmax&quot;</span>});</div><div class="line">    <a class="code" href="../../de/d6c/snippet_8h.html#aa592bfe3ce05ffc19a8f21d8482add6b">SET_DERIVED_PARAMS</a>({</div><div class="line">        {<span class="stringliteral">&quot;tauPlusDecay&quot;</span>, [](<span class="keyword">const</span> std::vector&lt;double&gt; &amp;pars, <span class="keywordtype">double</span> dt){ <span class="keywordflow">return</span> std::exp(-dt / pars[0]); }},</div><div class="line">        {<span class="stringliteral">&quot;tauMinusDecay&quot;</span>, [](<span class="keyword">const</span> std::vector&lt;double&gt; &amp;pars, <span class="keywordtype">double</span> dt){ <span class="keywordflow">return</span> std::exp(-dt / pars[1]); }}});</div><div class="line">    <a class="code" href="../../d4/d13/models_8h.html#a3025b9fc844fccdf8cc2b51ef4a6e0aa">SET_VARS</a>({{<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>}});</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a9a2bc6f56fa2bfb7008e915710720cfd">SET_PRE_VARS</a>({{<span class="stringliteral">&quot;preTrace&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>}});</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a906e656a5980ea57c9f1b7c3185e876b">SET_POST_VARS</a>({{<span class="stringliteral">&quot;postTrace&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>}});</div><div class="line">    </div><div class="line">    <a class="code" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;$(addToInSyn, $(g));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;const scalar dt = $(t) - $(sT_post); \n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;if (dt &gt; 0) {\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar newWeight = $(g) - ($(Aminus) * $(postTrace));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a9f1ad825b90bcbaab3b0d18fc4d00016">SET_LEARN_POST_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;const scalar dt = $(t) - $(sT_pre);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;if (dt &gt; 0) {\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    const scalar newWeight = $(g) + ($(Aplus) * $(preTrace));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;    $(g) = fmax($(Wmin), fmin($(Wmax), newWeight));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;}\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#aede2f97f853841236f081c8d7b9d156f">SET_PRE_SPIKE_CODE</a>(<span class="stringliteral">&quot;$(preTrace) += 1.0;\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#aef99e5858038673e6b268f4af07864c2">SET_POST_SPIKE_CODE</a>(<span class="stringliteral">&quot;$(postTrace) += 1.0;\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#ab7d8b101bdb0b7d593c9cc82f75a6853">SET_PRE_DYNAMICS_CODE</a>(<span class="stringliteral">&quot;$(preTrace) *= $(tauPlusDecay);\n&quot;</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a52759a81ea3269567b96c7b07a430ea6">SET_POST_DYNAMICS_CODE</a>(<span class="stringliteral">&quot;$(postTrace) *= $(tauMinusDecay);\n&quot;</span>);</div><div class="line">    </div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#ad06378df00a5d9ffe4068ba2c01b09ab">SET_NEEDS_PRE_SPIKE_TIME</a>(<span class="keyword">true</span>);</div><div class="line">    <a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a4f3e008922887cba8cfafc0fb0e53965">SET_NEEDS_POST_SPIKE_TIME</a>(<span class="keyword">true</span>);</div><div class="line">};</div><div class="line"><a class="code" href="../../d4/d13/models_8h.html#a0f3d066ed16dd93ee24912f38826520b">IMPLEMENT_MODEL</a>(STDPAdditive2);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">stdp_additive_2_model = genn_model.create_custom_weight_update_class(</div><div class="line">    <span class="stringliteral">&quot;stdp_additive_2&quot;</span>,</div><div class="line">    param_names=[<span class="stringliteral">&quot;tauPlus&quot;</span>, <span class="stringliteral">&quot;tauMinus&quot;</span>, <span class="stringliteral">&quot;aPlus&quot;</span>, <span class="stringliteral">&quot;aMinus&quot;</span>, <span class="stringliteral">&quot;wMin&quot;</span>, <span class="stringliteral">&quot;wMax&quot;</span>],</div><div class="line">    var_name_types=[(<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>)],</div><div class="line">    pre_var_name_types=[(<span class="stringliteral">&quot;preTrace&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>)],</div><div class="line">    post_var_name_types=[(<span class="stringliteral">&quot;postTrace&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>)],</div><div class="line">    </div><div class="line">    sim_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(addToInSyn, $(g));</span></div><div class="line"><span class="stringliteral">        const scalar dt = $(t) - $(sT_post);</span></div><div class="line"><span class="stringliteral">        if(dt &gt; 0) {</span></div><div class="line"><span class="stringliteral">            const scalar newWeight = $(g) - ($(aMinus) * $(postTrace));</span></div><div class="line"><span class="stringliteral">            $(g) = fmin($(wMax), fmax($(wMin), newWeight));</span></div><div class="line"><span class="stringliteral">        }</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    learn_post_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        const scalar dt = $(t) - $(sT_pre);</span></div><div class="line"><span class="stringliteral">        if(dt &gt; 0) {</span></div><div class="line"><span class="stringliteral">            const scalar newWeight = $(g) + ($(aPlus) * $(preTrace));</span></div><div class="line"><span class="stringliteral">            $(g) = fmin($(wMax), fmax($(wMin), newWeight));</span></div><div class="line"><span class="stringliteral">        }</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line"></div><div class="line">    pre_spike_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(preTrace) += 1.0;</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    pre_dynamics_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(preTrace) *= $(tauPlusDecay);</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    post_spike_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(postTrace) += 1.0;</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    post_dynamics_code=<span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;</span></div><div class="line"><span class="stringliteral">        $(postTrace) *= $(tauMinusDecay);</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span>,</div><div class="line">    </div><div class="line">    is_pre_spike_time_required=True,</div><div class="line">    is_post_spike_time_required=True)</div></div><!-- fragment --><p> </div></p>
<h2><a class="anchor" id="wum_synapse_dynamics"></a>
Synapse dynamics</h2>
<p>Unlike the event-driven updates previously described, synapse dynamics code is run for each synapse, each timestep i.e. unlike the others it is time-driven. This can be used where synapses have internal variables and dynamics that are described in continuous time, e.g. by ODEs. However using this mechanism is typically computationally very costly because of the large number of synapses in a typical network. By using the $(addToInSyn) and $(addToInSynDelay) functions discussed in the context of <a class="el" href="../../d3/dc0/neuronModels_8h.html#a8d014c818d8ee68f3a16838dcd4f030f">SET_SIM_CODE()</a>, the synapse dynamics can also be used to implement continuous synapses for rate-based models. Synapse dynamics code is added to a model using the <span class='toggleable_div label_cpp' style='display: none;'><code><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#ae68b0e54b73f5cda5fe9bab3667de3a8">SET_SYNAPSE_DYNAMICS_CODE()</a></code> macro </span><span class='toggleable_div label_python' style='display: none;'> <code>synapse_dynamics_code</code> keyword argument </span>, for example a continous synapse could be implemented as follows:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><a class="code" href="../../dc/dab/weightUpdateModels_8h.html#ae68b0e54b73f5cda5fe9bab3667de3a8">SET_SYNAPSE_DYNAMICS_CODE</a>(<span class="stringliteral">&quot;$(addToInSyn, $(g) * $(V_pre));&quot;</span>);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">synapse_dynamics_code=<span class="stringliteral">&quot;$(addToInSyn, $(g) * $(V_pre));&quot;</span>,</div></div><!-- fragment --><p> </div></p>
<h2><a class="anchor" id="wum_spike_like_events"></a>
Spike-like events</h2>
<p>As well as time-driven synapse dynamics and spike event-driven updates, GeNN weight update models also support "spike-like events". These are triggerd by a threshold condition &ndash; implemented with the code string specified using the <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a9e0fecc624daee536a388777788cd9de">SET_EVENT_THRESHOLD_CONDITION_CODE()</a> macro</span><span class='toggleable_div label_python' style='display: none;'><code>event_threshold_condition_code</code> keyword argument </span>. This typically involves the pre-synaptic variables, e.g. the membrane potential:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><a class="code" href="../../dc/dab/weightUpdateModels_8h.html#a9e0fecc624daee536a388777788cd9de">SET_EVENT_THRESHOLD_CONDITION_CODE</a>(<span class="stringliteral">&quot;$(V_pre) &gt; -0.02&quot;</span>);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">event_threshold_condition_code=<span class="stringliteral">&quot;$(V_pre) &gt; -0.02&quot;</span></div></div><!-- fragment --><p> </div> Whenever this expression evaluates to true, the event code set using the <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a8159c6f595e865d6bf609f045c07361e">SET_EVENT_CODE()</a> macro</span><span class='toggleable_div label_python' style='display: none;'><code>event_code</code> keyword argument </span> is executed. For an example, see <a class="el" href="../../d6/d64/classWeightUpdateModels_1_1StaticGraded.html" title="Graded-potential, static synapse. ">WeightUpdateModels::StaticGraded</a>. Weight update models can indicate whether they require the times of these spike-like-events using the <span class='toggleable_div label_cpp' style='display: none;'><a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a2995c30cbb73046095285c669cdcaed6">SET_NEEDS_PRE_SPIKE_EVENT_TIME()</a> and <a class="el" href="../../dc/dab/weightUpdateModels_8h.html#a238b505478cb5f9948a8d67cdda39dfb">SET_NEEDS_PREV_PRE_SPIKE_EVENT_TIME()</a> macros</span><span class='toggleable_div label_python' style='display: none;'> <code>is_pre_spike_event_time_required</code> and <code>is_prev_pre_spike_event_time_required</code> keyword arguments </span>. These times can then be accessed through the $(seT_pre) and $(prev_seT_pre) variables.</p>
<hr/>
<p> <a class="el" href="../../de/ded/sectNeuronModels.html">Previous</a> | <a class="el" href="../../dc/d05/UserManual.html">Top</a> | <a class="el" href="../../dd/de4/sect_postsyn.html">Next</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dc/d05/UserManual.html">User Manual</a></li>
    <li class="footer">Generated on Fri Apr 21 2023 16:20:24 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
<script type="text/javascript">
//<![CDATA[
addLanguageToggleButtons();
//]]>
</script>
</body>
</html>
