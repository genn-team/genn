<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>GeNN: Tutorial 1 (Python)</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../multi-language-utils.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="../../html_styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="../../GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">4.9.0</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d6/d8b/Tutorial1_Python.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 1 (Python) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial we will go through step by step instructions how to create and run your first PyGeNN simulation from scratch.</p>
<p>In this tutorial we will use a pre-defined Hodgkin-Huxley neuron model (<a class="el" href="../../d2/dc3/classNeuronModels_1_1TraubMiles.html" title="Hodgkin-Huxley neurons with Traub &amp; Miles algorithm. ">NeuronModels::TraubMiles</a>) and create a simulation consisting of ten such neurons without any synaptic connections. We will run this simulation on a GPU and plot the results using Matplotlib.</p>
<p>The first step is to create a new Python script. Create a new directory and, within that, create a new empty file called <code>tenHH.py</code> using your favourite text editor, e.g. </p><div class="fragment"><div class="line">&gt;&gt; emacs tenHH.py &amp;</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The "&gt;&gt;" in the example code snippets refers to a shell prompt in a unix shell, do not enter them as part of your shell commands.</dd></dl>
<p>This Python script will contain the definition of the network model as well as the code to simulate the model and plot the results. First, we need to import some classes from PyGeNN so we can reference them succinctly. Type in your <code>tenHH.py</code> file: </p><div class="fragment"><div class="line">from <a class="code" href="../../da/d6d/namespacepygenn.html">pygenn</a>.<a class="code" href="../../de/d6e/namespacepygenn_1_1genn__model.html">genn_model</a> <span class="keyword">import</span> GeNNModel</div></div><!-- fragment --><p> Two standard elements to the model definition are setting the simulation step size, the name of the model and the precision to simulate with: </p><div class="fragment"><div class="line">model = GeNNModel(<span class="stringliteral">&quot;float&quot;</span>, <span class="stringliteral">&quot;tenHH&quot;</span>)</div><div class="line">model.dT = 0.1</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>With this we have fixed the integration time step to <code>0.1</code> in the usual time units. The typical units in GeNN are <code>ms</code>, <code>mV</code>, <code>nF</code>, and <code>&mu;S</code>. Therefore, this defines <code>DT= 0.1 ms</code>.</dd></dl>
<p>Making the actual model definition makes use of the <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a100324e214546094fced5e66fb0582d4" title="Add a neuron population to the GeNN model. ">pygenn.GeNNModel.add_neuron_population</a> and <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#ab573f92c82ec25d5c80f94070b6008c0" title="Add a synapse population to the GeNN model. ">pygenn.GeNNModel.add_synapse_population</a> member functions of the pygenn.GeNNModel object. The arguments to a call to <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a100324e214546094fced5e66fb0582d4" title="Add a neuron population to the GeNN model. ">pygenn.GeNNModel.add_neuron_population</a> are: </p><ul>
<li><code>pop_name</code>: Unique name of the neuron population </li>
<li><code>num_neurons</code>: number of neurons in the population </li>
<li><code>neuron</code>: The type of neuron model. This should either be a string containing the name of a built in model or user-defined neuron type returned by <a class="el" href="../../de/d6e/namespacepygenn_1_1genn__model.html#a80f3b56cb2dc934ea04ed15a629c7db9" title="This helper function creates a custom NeuronModel class. ">pygenn.genn_model.create_custom_neuron_class</a> (see <a class="el" href="../../de/ded/sectNeuronModels.html">Neuron models</a>). </li>
<li><code>param_space</code>: Dictionary containing parameters of this neuron type </li>
<li><code>var_space</code>: Dictionary containing initial values or initialisation snippets for variables of this neuron type</li>
</ul>
<p>We first create the parameter and initial variable arrays, </p><div class="fragment"><div class="line">p = {<span class="stringliteral">&quot;gNa&quot;</span>: 7.15,   # Na conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;ENa&quot;</span>: 50.0,   # Na equi potential [mV]</div><div class="line">     <span class="stringliteral">&quot;gK&quot;</span>: 1.43,    # K conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;EK&quot;</span>: -95.0,   # K equi potential [mV] </div><div class="line">     <span class="stringliteral">&quot;gl&quot;</span>: 0.02672, # leak conductance [muS]</div><div class="line">     <span class="stringliteral">&quot;El&quot;</span>: -63.563, # El: leak equi potential in mV, </div><div class="line">     <span class="stringliteral">&quot;C&quot;</span>: 0.143}    # membr. capacity density in nF</div><div class="line"></div><div class="line">ini = {<span class="stringliteral">&quot;V&quot;</span>: -60.0,      # membrane potential</div><div class="line">       <span class="stringliteral">&quot;m&quot;</span>: 0.0529324,  # prob. <span class="keywordflow">for</span> Na channel activation</div><div class="line">       <span class="stringliteral">&quot;h&quot;</span>: 0.3176767,  # prob. <span class="keywordflow">for</span> not Na channel blocking</div><div class="line">       <span class="stringliteral">&quot;n&quot;</span>: 0.5961207}  # prob. <span class="keywordflow">for</span> K channel activation</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The comments are obviously only for clarity, they can in principle be omitted.</dd></dl>
<p>Having defined the parameter values and initial values we can now create the neuron population, </p><div class="fragment"><div class="line">pop1 = model.add_neuron_population(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, <span class="stringliteral">&quot;TraubMiles&quot;</span>, p, ini)</div></div><!-- fragment --><p>This model definition will generate code for simulating ten Hodgkin-Huxley neurons on the a GPU or CPU. The next stage is to write the code that sets up the simulation, does the data handling for input and output and generally defines the numerical experiment to be run. To build your model description into simulation code, simply call <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a860896623fb19b828a4ffa17bd664d08" title="Finalize and build a GeNN model. ">pygenn.GeNNModel.build</a> </p><div class="fragment"><div class="line">model.build()</div></div><!-- fragment --><p> If you have an NVIDIA GPU and <code>CUDA_PATH</code> is correctly configured, this will generate and build CUDA code to simulate your model. If not, it will generate and build C++ code. This completes the model definition in this example. The complete <code>tenHH.py</code> file now should look like this: </p><div class="fragment"><div class="line">from <a class="code" href="../../da/d6d/namespacepygenn.html">pygenn</a>.<a class="code" href="../../de/d6e/namespacepygenn_1_1genn__model.html">genn_model</a> <span class="keyword">import</span> GeNNModel</div><div class="line"></div><div class="line">model = GeNNModel(<span class="stringliteral">&quot;float&quot;</span>, <span class="stringliteral">&quot;tenHH&quot;</span>)</div><div class="line">model.dT = 0.1</div><div class="line"></div><div class="line">p = {<span class="stringliteral">&quot;gNa&quot;</span>: 7.15,   # Na conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;ENa&quot;</span>: 50.0,   # Na equi potential [mV]</div><div class="line">     <span class="stringliteral">&quot;gK&quot;</span>: 1.43,    # K conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;EK&quot;</span>: -95.0,   # K equi potential [mV] </div><div class="line">     <span class="stringliteral">&quot;gl&quot;</span>: 0.02672, # leak conductance [muS]</div><div class="line">     <span class="stringliteral">&quot;El&quot;</span>: -63.563, # El: leak equi potential in mV, </div><div class="line">     <span class="stringliteral">&quot;C&quot;</span>: 0.143}    # membr. capacity density in nF</div><div class="line"></div><div class="line">ini = {<span class="stringliteral">&quot;V&quot;</span>: -60.0,      # membrane potential</div><div class="line">       <span class="stringliteral">&quot;m&quot;</span>: 0.0529324,  # prob. <span class="keywordflow">for</span> Na channel activation</div><div class="line">       <span class="stringliteral">&quot;h&quot;</span>: 0.3176767,  # prob. <span class="keywordflow">for</span> not Na channel blocking</div><div class="line">       <span class="stringliteral">&quot;n&quot;</span>: 0.5961207}  # prob. <span class="keywordflow">for</span> K channel activation</div><div class="line"></div><div class="line">pop1 = model.add_neuron_population(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, <span class="stringliteral">&quot;TraubMiles&quot;</span>, p, ini)</div><div class="line"></div><div class="line">model.build()</div></div><!-- fragment --><h1><a class="anchor" id="userCode"></a>
User Code</h1>
<p>The generated code to simulate the model will now have been generated. To make use of this code, we need to load it into PyGeNN: </p><div class="fragment"><div class="line">model.load()</div></div><!-- fragment --><p> For the purposes of this tutorial we will initially simply run the model for 200ms and print the final neuron variables. To do so, we add: </p><dl class="section note"><dt>Note</dt><dd>The <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a48193c41cf24f25cdd2970cab7c88e87" title="Simulation time in ms. ">pygenn.GeNNModel.t</a> property keeps track of the current simulation time in milliseconds.</dd></dl>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> model.t &lt; 200.0</div><div class="line">    model.step_time()</div></div><!-- fragment --><p> and we need to copy the result back to the host (this will do nothing if you are running the model on a CPU) before printing it out, </p><div class="fragment"><div class="line">pop1.pull_state_from_device()</div><div class="line">v_view = pop1.vars[<span class="stringliteral">&quot;V&quot;</span>].view</div><div class="line">m_view = pop1.vars[<span class="stringliteral">&quot;m&quot;</span>].view</div><div class="line">h_view = pop1.vars[<span class="stringliteral">&quot;h&quot;</span>].view</div><div class="line">n_view = pop1.vars[<span class="stringliteral">&quot;n&quot;</span>].view</div><div class="line"></div><div class="line"><span class="keywordflow">for</span> j in range(10):</div><div class="line">    print(<span class="stringliteral">&quot;%f %f %f %f&quot;</span> % (v_view[j], m_view[j], h_view[j], n_view[j]))</div></div><!-- fragment --><p> <a class="el" href="../../d1/db3/classpygenn_1_1genn__groups_1_1Group.html#ab075765fe8c89bd2f1285a0beccf8675" title="Wrapper around GeNNModel.pull_state_from_device. ">pygenn.NeuronGroup.pull_state_from_device</a> copies all relevant state variables of the neuron group from the GPU to the CPU main memory. We can then get direct access to the host-allocated memory using a 'view' and finally output the results to stdout by looping through all 10 neurons and outputting the state variables via their views.</p>
<p>This completes the first version of the script. The complete <code>tenHH.py</code> file should now look like </p><div class="fragment"><div class="line">from <a class="code" href="../../da/d6d/namespacepygenn.html">pygenn</a>.<a class="code" href="../../de/d6e/namespacepygenn_1_1genn__model.html">genn_model</a> <span class="keyword">import</span> GeNNModel</div><div class="line"></div><div class="line">model = GeNNModel(<span class="stringliteral">&quot;float&quot;</span>, <span class="stringliteral">&quot;tenHH&quot;</span>)</div><div class="line">model.dT = 0.1</div><div class="line"></div><div class="line">p = {<span class="stringliteral">&quot;gNa&quot;</span>: 7.15,   # Na conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;ENa&quot;</span>: 50.0,   # Na equi potential [mV]</div><div class="line">     <span class="stringliteral">&quot;gK&quot;</span>: 1.43,    # K conductance in [muS]</div><div class="line">     <span class="stringliteral">&quot;EK&quot;</span>: -95.0,   # K equi potential [mV] </div><div class="line">     <span class="stringliteral">&quot;gl&quot;</span>: 0.02672, # leak conductance [muS]</div><div class="line">     <span class="stringliteral">&quot;El&quot;</span>: -63.563, # El: leak equi potential in mV, </div><div class="line">     <span class="stringliteral">&quot;C&quot;</span>: 0.143}    # membr. capacity density in nF</div><div class="line"></div><div class="line">ini = {<span class="stringliteral">&quot;V&quot;</span>: -60.0,      # membrane potential</div><div class="line">       <span class="stringliteral">&quot;m&quot;</span>: 0.0529324,  # prob. <span class="keywordflow">for</span> Na channel activation</div><div class="line">       <span class="stringliteral">&quot;h&quot;</span>: 0.3176767,  # prob. <span class="keywordflow">for</span> not Na channel blocking</div><div class="line">       <span class="stringliteral">&quot;n&quot;</span>: 0.5961207}  # prob. <span class="keywordflow">for</span> K channel activation</div><div class="line"></div><div class="line">pop1 = model.add_neuron_population(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, <span class="stringliteral">&quot;TraubMiles&quot;</span>, p, ini)</div><div class="line"></div><div class="line">model.build()</div><div class="line">model.load()</div><div class="line"></div><div class="line"><span class="keywordflow">while</span> model.t &lt; 200.0:</div><div class="line">    model.step_time()</div><div class="line"></div><div class="line">pop1.pull_state_from_device()</div><div class="line">v_view = pop1.vars[<span class="stringliteral">&quot;V&quot;</span>].view</div><div class="line">m_view = pop1.vars[<span class="stringliteral">&quot;m&quot;</span>].view</div><div class="line">h_view = pop1.vars[<span class="stringliteral">&quot;h&quot;</span>].view</div><div class="line">n_view = pop1.vars[<span class="stringliteral">&quot;n&quot;</span>].view</div><div class="line"></div><div class="line"><span class="keywordflow">for</span> j in range(10):</div><div class="line">    print(<span class="stringliteral">&quot;%f %f %f %f&quot;</span> % (v_view[j], m_view[j], h_view[j], n_view[j]))</div></div><!-- fragment --><h1><a class="anchor" id="RunningSim"></a>
Running the Simulation</h1>
<p>You can now execute your newly-built simulator with </p><div class="fragment"><div class="line">&gt;&gt; python tenHH.py</div></div><!-- fragment --><p>The output you obtain should look like </p><div class="fragment"><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div><div class="line">-63.305061 0.020786 0.993780 0.049409</div></div><!-- fragment --><h1><a class="anchor" id="Input"></a>
Reading</h1>
<p>This is not particularly interesting as we are just observing the final value of the membrane potentials. To see what is going on in the meantime, we need to copy intermediate values from the device into a data structure and plot them. This can be done in many ways but one sensible way of doing this is to replace the calls to <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a6d71c8d91805b64c5a69fc62ea3dfbdb" title="Make one simulation step. ">pygenn.GeNNModel.step_time</a> in <code>tenHH.py</code> with something like this: </p><div class="fragment"><div class="line">v = np.empty((2000, 10))</div><div class="line">v_view = pop1.vars[<span class="stringliteral">&quot;V&quot;</span>].view</div><div class="line"><span class="keywordflow">while</span> model.t &lt; 200.0:</div><div class="line">    model.step_time()</div><div class="line"></div><div class="line">    pop1.pull_var_from_device(<span class="stringliteral">&quot;V&quot;</span>)</div><div class="line">    </div><div class="line">    v[model.timestep - 1,:]=v_view[:]</div></div><!-- fragment --><p> You will also need to add: </p><div class="fragment"><div class="line"><span class="keyword">import</span> numpy as np</div></div><!-- fragment --><p> to the top of tenHH.py. </p><dl class="section note"><dt>Note</dt><dd>The <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#aef0498990a471f39daad3fd841df7111" title="Simulation time step. ">pygenn.GeNNModel.timestep</a> property keeps track of the current simulation timestep count. This is updated at the end of <a class="el" href="../../db/d57/classpygenn_1_1genn__model_1_1GeNNModel.html#a6d71c8d91805b64c5a69fc62ea3dfbdb" title="Make one simulation step. ">pygenn.GeNNModel.step_time</a> so here, we subtract 1 from it to obtain indices into our array from 0 to 9999. </dd>
<dd>
We switched from using <a class="el" href="../../d1/db3/classpygenn_1_1genn__groups_1_1Group.html#ab075765fe8c89bd2f1285a0beccf8675" title="Wrapper around GeNNModel.pull_state_from_device. ">pygenn.NeuronGroup.pull_state_from_device</a> to pygenn.genn_group.NeuronGroup.pull_var_from_device as we are now only interested in the membrane voltage of the neuron.</dd></dl>
<p>Finally, if we add: </p><div class="fragment"><div class="line">fig, axis = plt.subplots()</div><div class="line">axis.plot(v)</div><div class="line">plt.show()</div></div><!-- fragment --><p> to the bottom of <code>tenHH.py</code> and: </p><div class="fragment"><div class="line"><span class="keyword">import</span> matplotlib.pyplot as plt</div></div><!-- fragment --><p> to the top, if you run the simulation again as described above you should observe dynamics like this: </p><div class="image">
<img src="../../tenHHexample.png" alt="tenHHexample.png"/>
</div>
 <p>However so far, the neurons are not connected and do not receive input. As the <a class="el" href="../../d2/dc3/classNeuronModels_1_1TraubMiles.html" title="Hodgkin-Huxley neurons with Traub &amp; Miles algorithm. ">NeuronModels::TraubMiles</a> model is silent in such conditions, the membrane voltages of the 10 neurons will simply drift from the -60mV they were initialised at to their resting potential.</p>
<hr/>
<p> <a class="el" href="../../d5/dbb/Tutorial1.html">Previous</a> | <a class="el" href="../../d6/d8b/Tutorial1_Python.html">Top</a> | <a class="el" href="../../dc/d7e/Tutorial2.html">Next</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Oct 11 2023 10:51:15 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
<script type="text/javascript">
//<![CDATA[
addLanguageToggleButtons();
//]]>
</script>
</body>
</html>
