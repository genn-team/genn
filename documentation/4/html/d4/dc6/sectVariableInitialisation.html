<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>GeNN: Variable initialisation</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../multi-language-utils.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="../../html_styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="../../GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">4.7.0</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/dc6/sectVariableInitialisation.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Variable initialisation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Neuron, weight update, postsynaptic and custom update models all have state variables which GeNN can automatically initialise.</p>
<p>Previously we have shown variables being initialised to constant values such as:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><a class="code" href="../../db/dbb/classSnippet_1_1InitialiserContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    0.0529324,     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">ini = {<span class="stringliteral">&quot;m&quot;</span>: 0.0529324, ...}</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_cpp' style='display: none;'> state variables can also be left <em>uninitialised</em> leaving it up to the user code to initialise them between the calls to <code>initialize()</code> and <code>initializeSparse()</code>:</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbb/classSnippet_1_1InitialiserContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    <a class="code" href="../../dc/de1/modelSpec_8h.html#a6bd7d3c3ead0a4d0ffb15d2a4c67d043">uninitialisedVar</a>(),     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --><p>  </div>  <div class='toggleable_div label_python' style='display: none;'> state variables can alse be manually initialised to values specified in a numpy array: </p><div class="fragment"><div class="line">ini = {<span class="stringliteral">&quot;m&quot;</span>: np.arange(400.0), ...}</div></div><!-- fragment --><p>  </div> or initialised using one of a number of predefined <em>variable initialisation snippets</em>:</p><ul>
<li><a class="el" href="../../df/d7b/classInitVarSnippet_1_1Kernel.html" title="Used to initialise synapse variables from a kernel. ">InitVarSnippet::Kernel</a></li>
<li><a class="el" href="../../dd/da0/classInitVarSnippet_1_1Uniform.html" title="Initialises variable by sampling from the uniform distribution. ">InitVarSnippet::Uniform</a></li>
<li><a class="el" href="../../d5/dc1/classInitVarSnippet_1_1Normal.html" title="Initialises variable by sampling from the normal distribution. ">InitVarSnippet::Normal</a></li>
<li><a class="el" href="../../d7/d22/classInitVarSnippet_1_1NormalClipped.html">InitVarSnippet::NormalClipped</a></li>
<li><a class="el" href="../../d4/d87/classInitVarSnippet_1_1NormalClippedDelay.html">InitVarSnippet::NormalClippedDelay</a></li>
<li><a class="el" href="../../d8/d70/classInitVarSnippet_1_1Exponential.html" title="Initialises variable by sampling from the exponential distribution. ">InitVarSnippet::Exponential</a></li>
<li><a class="el" href="../../d0/d54/classInitVarSnippet_1_1Gamma.html" title="Initialises variable by sampling from the gamma distribution. ">InitVarSnippet::Gamma</a></li>
<li><a class="el" href="../../dc/dda/classInitVarSnippet_1_1Binomial.html" title="Initialises variable by sampling from the binomial distribution. ">InitVarSnippet::Binomial</a></li>
</ul>
<p> <div class='toggleable_div label_python' style='display: none;'> In Python, these models can be selected by their unqualified name e.g. "Normal".  </div> For example, to initialise a parameter using values drawn from the normal distribution:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line">InitVarSnippet::Normal::ParamValues params(</div><div class="line">    0.05,   <span class="comment">// 0 - mean</span></div><div class="line">    0.01);  <span class="comment">// 1 - standard deviation</span></div><div class="line">    </div><div class="line"><a class="code" href="../../db/dbb/classSnippet_1_1InitialiserContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    initVar&lt;InitVarSnippet::Normal&gt;(params),     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">params = {<span class="stringliteral">&quot;mean&quot;</span>: 0.05, <span class="stringliteral">&quot;sd&quot;</span>: 0.01}</div><div class="line">ini = {<span class="stringliteral">&quot;m&quot;</span>: genn_model.init_var(<span class="stringliteral">&quot;Normal&quot;</span>, params), ...}</div></div><!-- fragment --><p> </div> </p>
<h1><a class="anchor" id="sect_new_var_init"></a>
Defining a new variable initialisation snippet</h1>
<p>Similarly to neuron, weight update and postsynaptic models, new variable initialisation snippets can be created by simply defining a class in the model description. For example, when initialising excitatory (positive) synaptic weights with a normal distribution they should be clipped at 0 so the long tail of the normal distribution doesn't result in negative weights. This could be implemented using the following variable initialisation snippet which redraws until samples are within the desired bounds:  <div class='toggleable_div label_cpp' style='display: none;'></p><div class="fragment"><div class="line"><span class="keyword">class </span>NormalPositive : <span class="keyword">public</span> <a class="code" href="../../d3/d9e/classInitVarSnippet_1_1Base.html">InitVarSnippet::Base</a></div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <a class="code" href="../../de/d6c/snippet_8h.html#ac5727a6720d28f034afadde948ed6e9a">DECLARE_SNIPPET</a>(NormalPositive, 2);</div><div class="line"></div><div class="line">    <a class="code" href="../../d9/ddf/initVarSnippet_8h.html#a4b6549c5c6a7a5b8058283d68fa11578">SET_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;scalar normal;\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;do\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;{\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;   normal = $(mean) + ($(gennrand_normal) * $(sd));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;} while (normal &lt; 0.0);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;$(value) = normal;\n&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="../../de/d6c/snippet_8h.html#a75315265035fd71c5b5f7d7f449edbd7">SET_PARAM_NAMES</a>({<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;sd&quot;</span>});</div><div class="line">};</div><div class="line"><a class="code" href="../../de/d6c/snippet_8h.html#af3c47debe5fc34060e716d7db25462ab">IMPLEMENT_SNIPPET</a>(NormalPositive);</div></div><!-- fragment --><p> </div>  <div class='toggleable_div label_python' style='display: none;'></p><div class="fragment"><div class="line">normal_positive_model = genn_model.create_custom_init_var_snippet_class(</div><div class="line">    <span class="stringliteral">&quot;normal_positive&quot;</span>,</div><div class="line">    param_names=[<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;sd],</span></div><div class="line"><span class="stringliteral">    var_init_code=</span></div><div class="line"><span class="stringliteral">        &quot;</span><span class="stringliteral">&quot;&quot;</span></div><div class="line">        <a class="code" href="../../d5/dc1/namespaceSpineMLSimulator.html#aac5bd629c196eee813b33954f676373e">scalar</a> normal;</div><div class="line">        <span class="keywordflow">do</span></div><div class="line">        {</div><div class="line">           normal = $(mean) + ($(gennrand_normal) * $(sd));</div><div class="line">        } <span class="keywordflow">while</span> (normal &lt; 0.0);</div><div class="line">        $(value) = normal;</div><div class="line">        <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;)</span></div></div><!-- fragment --><p> </div> Within the snippet of code specified using the <span class='toggleable_div label_cpp' style='display: none;'><code><a class="el" href="../../d9/ddf/initVarSnippet_8h.html#a4b6549c5c6a7a5b8058283d68fa11578">SET_CODE()</a></code> macro </span><span class='toggleable_div label_python' style='display: none;'> <code>var_init_code</code> keyword argument </span>, when initialisising neuron and postaynaptic model state variables , the $(id) variable can be used to access the id of the neuron being initialised. Similarly, when initialising weight update model state variables, the $(id_pre) and $(id_post) variables can used to access the ids of the pre and postsynaptic neurons connected by the synapse being initialised.</p>
<h1><a class="anchor" id="sect_var_init_modes"></a>
Variable locations</h1>
<p>Once you have defined <b>how</b> your variables are going to be initialised you need to configure <b>where</b> they will be allocated. By default memory is allocated for variables on both the GPU and the host. However, the following alternative 'variable locations' are available:</p><ul>
<li><a class="el" href="../../d6/d8f/variableMode_8h.html#a2807180f6261d89020cf7d7d498fb087ae10b6ab6a278644ce40631f62f360b6d">VarLocation::DEVICE</a> - Variables are only allocated on the GPU, saving memory but meaning that they can't easily be copied to the host - best for internal state variables.</li>
<li><a class="el" href="../../d6/d8f/variableMode_8h.html#a2807180f6261d89020cf7d7d498fb087aa34547c8e93e562b2c7952c77d426710">VarLocation::HOST_DEVICE</a> - Variables are allocated on both the GPU and the host - the default.</li>
<li><a class="el" href="../../d6/d8f/variableMode_8h.html#a2807180f6261d89020cf7d7d498fb087a42b7a82fbd6d845b0d5c5dbd67846e0d">VarLocation::HOST_DEVICE_ZERO_COPY</a> - Variables are allocated as 'zero-copy' memory accessible to the host and GPU - useful on devices such as Jetson TX1 where physical memory is shared between the GPU and CPU.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>'Zero copy' memory is only supported on newer embedded systems such as the Jetson TX1 where there is no physical seperation between GPU and host memory and thus the same block of memory can be shared between them.</dd></dl>
<p>These modes can be set as a model default using <code><a class="el" href="../../da/dfd/classModelSpec.html#a55c87917355d34463a3c19fc6887e67a" title="What is the default location for model state variables? ">ModelSpec::setDefaultVarLocation</a></code> or on a per-variable basis using one of the following functions:</p><ul>
<li><a class="el" href="../../d7/d3b/classNeuronGroup.html#a9df1df6d85dde4a46ddef63954828a95" title="Set location of this neuron group&#39;s output spikes. ">NeuronGroup::setSpikeLocation</a></li>
<li><a class="el" href="../../d7/d3b/classNeuronGroup.html#a95f0660e93790ea764119002db68f706" title="Set location of this neuron group&#39;s output spike events. ">NeuronGroup::setSpikeEventLocation</a></li>
<li><a class="el" href="../../d7/d3b/classNeuronGroup.html#a63004d6ff9f5b2982ef401e95314d531" title="Set location of this neuron group&#39;s output spike times. ">NeuronGroup::setSpikeTimeLocation</a></li>
<li><a class="el" href="../../d7/d3b/classNeuronGroup.html#a75951040bc142c60c4f0b5a8aa84bd57" title="Set variable location of neuron model state variable. ">NeuronGroup::setVarLocation</a></li>
<li><a class="el" href="../../dc/dfa/classSynapseGroup.html#a36fd4856ed157898059c1aab176c02b8" title="Set location of weight update model state variable. ">SynapseGroup::setWUVarLocation</a></li>
<li><a class="el" href="../../dc/dfa/classSynapseGroup.html#a2b4a14a357b0f00020f632a440a3c048" title="Set location of weight update model presynaptic state variable. ">SynapseGroup::setWUPreVarLocation</a></li>
<li><a class="el" href="../../dc/dfa/classSynapseGroup.html#abce72af57aaeb5cbeb3b6e1a849b1e1e" title="Set location of weight update model postsynaptic state variable. ">SynapseGroup::setWUPostVarLocation</a></li>
<li><a class="el" href="../../dc/dfa/classSynapseGroup.html#ad394ea032564c35d3228c3e1c1704f54" title="Set location of postsynaptic model state variable. ">SynapseGroup::setPSVarLocation</a></li>
<li><a class="el" href="../../dc/dfa/classSynapseGroup.html#a871ba5677d4b088443eb43d3c3036114" title="Set location of variables used to combine input from this synapse group. ">SynapseGroup::setInSynVarLocation</a></li>
</ul>
<hr/>
<p> <a class="el" href="../../d5/d39/subsect34.html">Previous</a> | <a class="el" href="../../dc/d05/UserManual.html">Top</a> | <a class="el" href="../../de/d71/sectVariableReferences.html">Next</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dc/d05/UserManual.html">User Manual</a></li>
    <li class="footer">Generated on Fri Feb 11 2022 17:17:45 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
<script type="text/javascript">
//<![CDATA[
addLanguageToggleButtons();
//]]>
</script>
</body>
</html>
