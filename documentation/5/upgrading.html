<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upgrading from GeNN 4 &mdash; PyGeNN  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building networks" href="building_networks.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyGeNN
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Upgrading from GeNN 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_networks.html">Building networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulating_networks.html">Simulating networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_models.html">Custom models</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="userproject/index.html">User projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/pygenn.html">Reference documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyGeNN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Upgrading from GeNN 4</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/upgrading.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="upgrading-from-genn-4">
<h1>Upgrading from GeNN 4<a class="headerlink" href="#upgrading-from-genn-4" title="Link to this heading"></a></h1>
<p>GeNN 5 does not aim to be a backward-compatible upgrade.
In PyGeNN we have strived to add backward compatibility where possible but most models will need to be updated.</p>
<section id="genncode">
<h2>GeNNCode<a class="headerlink" href="#genncode" title="Link to this heading"></a></h2>
<p>In GeNN 4, GeNNCode was passed directly to the underlying compiler whereas, in GeNN 5, it is parsed and only a subset of C99 language features are supported.
In PyGeNN,</p>
<ul class="simple">
<li><p>The &amp; operator isn’t supported - on the target GPU hardware, local variables are assumed to be stored in registers and not addressable. The only time this is limiting is when dealing with extra global parameter arrays as you can no longer do something like <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">int</span> <span class="pre">*egpSubset</span> <span class="pre">=</span> <span class="pre">&amp;egp[offset];</span></code> and instead have to use <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">int</span> <span class="pre">*egpSubset</span> <span class="pre">=</span> <span class="pre">egp</span> <span class="pre">+</span> <span class="pre">offset;</span></code>.</p></li>
<li><p>The old <code class="docutils literal notranslate"><span class="pre">$(xx)</span></code> syntax for referencing GeNN parameters and variables, etc. is no longer necessary.</p></li>
</ul>
</section>
<section id="syntax-changes">
<h2>Syntax changes<a class="headerlink" href="#syntax-changes" title="Link to this heading"></a></h2>
<p>In order to streamline the modelling process and reduce the number of ways to achieve the same thing,
several areas of GeNN syntax have changed:</p>
<ul>
<li><p>Postsynaptic models were previously implemented with two code strings: <code class="docutils literal notranslate"><span class="pre">apply_input_code</span></code> and
<code class="docutils literal notranslate"><span class="pre">decay_code</span></code>. This was unnecessarily complex and the order these were evaluated in wasn’t obvious.
Therefore, these have been replaced by a single <code class="docutils literal notranslate"><span class="pre">sim_code</span></code> code string from which input can be
delivered to the postsynaptic neuron using the <code class="docutils literal notranslate"><span class="pre">injectCurrent(x)</span></code> function.</p></li>
<li><p><a class="reference internal" href="source/pygenn.html#pygenn.GeNNModel.add_synapse_population" title="pygenn.GeNNModel.add_synapse_population"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeNNModel.add_synapse_population()</span></code></a> was becoming rather cumbersome and this was only made worse by postsynaptic models and weight update models now taking variable references.
To improve this:</p>
<blockquote>
<div><ul class="simple">
<li><p>Axonal delay is now no longer a required parameter and, if required, can now be set using <a class="reference internal" href="source/pygenn.html#pygenn.SynapseGroup.axonal_delay_steps" title="pygenn.SynapseGroup.axonal_delay_steps"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseGroup.axonal_delay_steps</span></code></a></p></li>
<li><p>The postsynaptic and weight update models used by the synapse group are initialised seperately using <a class="reference internal" href="source/pygenn.html#pygenn.init_postsynaptic" title="pygenn.init_postsynaptic"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_postsynaptic()</span></code></a> and <a class="reference internal" href="source/pygenn.html#pygenn.init_weight_update" title="pygenn.init_weight_update"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_weight_update()</span></code></a> respectively.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The row build and diagonal build state variables in sparse/toeplitz connectivity building code were really ugly and confusing. Sparse connectivity init snippets now just let the user write whatever sort of loop they want and do the initialisation outside and toeplitz reuses the for_each_synapse structure described above to do similar.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GLOBALG</span></code> and <code class="docutils literal notranslate"><span class="pre">INDIVIDUALG</span></code> confused almost all new users and were really only used with <code class="docutils literal notranslate"><span class="pre">StaticPulse</span></code> weight update models. The same functionality can be achieved with a <code class="docutils literal notranslate"><span class="pre">StaticPulseConstantWeight</span></code> version with the weight as a parameter. Then I’ve renamed all the ‘obvious’ <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType" title="pygenn.SynapseMatrixType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynapseMatrixType</span></code></a> variants so you just choose <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.SPARSE" title="pygenn.SynapseMatrixType.SPARSE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.SPARSE</span></code></a>, <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.DENSE" title="pygenn.SynapseMatrixType.DENSE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.DENSE</span></code></a>, <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.TOEPLITZ" title="pygenn.SynapseMatrixType.TOEPLITZ"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.TOEPLITZ</span></code></a> or <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.PROCEDURAL" title="pygenn.SynapseMatrixType.PROCEDURAL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.PROCEDURAL</span></code></a> (with <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.DENSE_PROCEDURALG" title="pygenn.SynapseMatrixType.DENSE_PROCEDURALG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.DENSE_PROCEDURALG</span></code></a> and <a class="reference internal" href="source/pygenn.html#pygenn.SynapseMatrixType.PROCEDURAL_KERNELG" title="pygenn.SynapseMatrixType.PROCEDURAL_KERNELG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SynapseMatrixType.PROCEDURAL_KERNELG</span></code></a> for more unusual options)</p></li>
<li><p>Extra global parameters used to be creatable with pointer types to allow models to access
arbitrary sized arrays and non-pointer types to create parameters that could be modified at runtime.
The latter use case is now handled much more efficiently using the <a class="reference internal" href="simulating_networks.html#section-dynamic-parameters"><span class="std std-ref">Dynamic parameters</span></a> system.</p></li>
<li><p>Weight update and postsynaptic models could previous refer to neuron variables via <em>implicit</em>
references. For example <code class="docutils literal notranslate"><span class="pre">$(V_pre)</span></code> would refer to a variable called <code class="docutils literal notranslate"><span class="pre">V</span></code> on the presynaptic
neuron population. This mechanism has been replaced by adding <em>explicit</em> references to
weight update, postsynaptic and current source model (see <a class="reference internal" href="building_networks.html#section-variables-references"><span class="std std-ref">Variables references</span></a>).</p></li>
<li><p>It used to be possible to interact directly with the underlying spike data structures
used by GeNN to inject or record spikes. However, this was very innefficient and is no
longer supported. Even if you need to access recorded spikes every timestep, using the
<a class="reference internal" href="simulating_networks.html#section-spike-recording"><span class="std std-ref">Spike recording</span></a> system is still more efficient and to inject spikes we recommend using
either the built-in <code class="docutils literal notranslate"><span class="pre">SpikeSourceArray</span></code> model (as described in <a class="reference internal" href="simulating_networks.html#section-extra-global-parameters"><span class="std std-ref">Extra global parameters</span></a>)
or a custom <a class="reference internal" href="custom_models.html#section-neuron-models"><span class="std std-ref">Neuron models</span></a>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="building_networks.html" class="btn btn-neutral float-right" title="Building networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, James Knight, Thomas Nowotny.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>